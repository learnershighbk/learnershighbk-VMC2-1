# 홈(Home) 페이지 유스케이스

## Primary Actor
- 공연을 탐색하려는 일반 사용자

## Precondition
- 사용자는 브라우저로 서비스 홈 URL에 접근할 수 있다.
- 사용자는 기본 네트워크 연결을 보유하고 있다(오프라인 모드는 캐시 데이터만 표시 가능).

## Trigger
- 사용자가 홈 페이지에 진입하거나 새로고침한다.

## Main Scenario
1. FE는 로컬 캐시가 있다면 우선 렌더링한다.
2. FE는 정렬/필터 상태를 쿼리 파라미터로 구성해 BE에 콘서트 목록을 요청한다.
3. BE는 입력 파라미터를 검증하고 `concerts` 및 필요 시 `seat_classes` 집계 쿼리를 수행한다.
4. Database는 조건에 맞는 콘서트 목록과 잔여 좌석 요약을 반환한다.
5. BE는 페이지네이션 메타와 함께 성공 응답을 반환한다.
6. FE는 응답을 수신해 콘서트 카드 리스트를 렌더링하고, 스크롤/필터 UI를 활성화한다.
7. 사용자가 콘서트 카드를 클릭하면 FE는 상세 페이지로 라우팅한다.

## Edge Cases
- 콘서트가 없는 경우: FE는 빈 상태 메시지를 노출한다.
- 데이터 일부 누락: 해당 카드만 스켈레톤 또는 비표시 처리하고 로그를 전송한다.
- 네트워크 오류/타임아웃: FE는 오류 토스트와 재시도 버튼을 제공하고, BE는 오류 코드를 표준화한다.
- 중복 클릭: FE는 카드 클릭에 디바운스 또는 1회성 네비게이션을 적용한다.
- 오프라인 진입: FE는 캐시 데이터를 표시하고 온라인 전환 시 자동 재동기화한다.

## Business Rules
- 기본 정렬은 최신 공연 일정 오름차순이며, 사용자가 변경하면 해당 상태를 쿼리 파라미터로 유지한다.
- 필터와 정렬 조합은 허용된 파라미터 목록에 한정한다.
- 최대 페이지네이션 크기는 서버 설정 값을 초과할 수 없다.
- FE는 WCAG 기준에 맞춰 키보드 포커스를 이동하며, 스켈레톤은 최소정보를 포함한다.
- BE는 동일 요청 간 지수 백오프 재시도 정책을 적용한다.

```
@startuml
actor User
participant FE
participant BE
database Database

User -> FE: 홈 페이지 접속
FE -> FE: 캐시 확인 및 스켈레톤 렌더링
FE -> BE: GET /concerts?sort&filter&page
BE -> BE: 파라미터 검증
BE -> Database: concerts + seat_classes 집계 조회
Database --> BE: 콘서트 목록
BE --> FE: 200 OK + 목록/메타 정보
FE -> User: 콘서트 카드 렌더링
User -> FE: 콘서트 카드 클릭
FE -> User: 상세 페이지로 라우팅
@enduml
```


# 콘서트 상세 페이지 유스케이스

## Primary Actor
- 특정 공연 정보를 확인하고 예약을 준비하는 사용자

## Precondition
- 사용자는 홈 또는 공유 링크를 통해 콘서트 상세 URL에 접근할 수 있다.
- 사용자는 예약 가능 상태인지 확인하고자 한다.

## Trigger
- 사용자가 콘서트 상세 페이지로 이동한다.

## Main Scenario
1. FE는 페이지 진입 시 콘서트 ID를 기반으로 로딩 상태를 표시한다.
2. FE는 BE에 콘서트 기본 정보 및 좌석 등급 정보를 조회한다.
3. BE는 콘서트 활성 여부를 검증하고 `concerts`와 `seat_classes` 데이터를 조회한다.
4. Database는 공연 기본 정보와 등급별 좌석 잔여 데이터를 반환한다.
5. BE는 데이터 일관성을 확인 후 FE에 전달한다.
6. FE는 상세 정보(포스터, 일정, 설명, 좌석 요약)를 렌더링한다.
7. 사용자가 `예약하기` 버튼을 클릭하면 FE는 좌석 선택 페이지로 라우팅한다.

## Edge Cases
- 공연이 비활성 또는 판매 중단 상태: FE는 예약 버튼을 비활성화하고 안내 메시지를 표시한다.
- 좌석 등급 데이터 누락: 해당 등급 섹션을 숨기고 로깅한다.
- 공연이 이미 종료된 경우: FE는 예약 버튼을 감추고 `종료된 공연` 배지를 노출한다.
- 네트워크 실패: FE는 오류 컴포넌트를 표시하고 재시도 버튼을 제공한다.
- 데이터 지연: FE는 좌석 잔여 수에 대해 스켈레톤을 유지하며 실제 데이터 수신 후 갱신한다.

## Business Rules
- 예약 버튼은 공연이 판매 중이며 현재 시간이 공연 시작 전일 때만 활성화된다.
- 좌석 잔여 수는 BE가 계산하여 최소값 보장(0 미만 허용하지 않음).
- 공연 설명은 마크다운/리치텍스트가 아닌 단순 텍스트로 제공된다.
- BE는 콘서트 ID가 유효하지 않은 경우 표준 에러 응답을 반환한다.
- FE는 페이지 뷰 로깅 시 사용자 식별 정보를 포함하지 않는다.

```
@startuml
actor User
participant FE
participant BE
database Database

User -> FE: 콘서트 상세 페이지 진입
FE -> FE: 로딩 상태 표시
FE -> BE: GET /concerts/{id}
BE -> BE: 공연 상태 및 권한 검증
BE -> Database: concerts, seat_classes 조회
Database --> BE: 공연 상세 + 좌석 등급 데이터
BE --> FE: 200 OK + 공연 상세 응답
FE -> User: 공연 상세 정보 및 예약 버튼 렌더링
User -> FE: 예약하기 클릭
FE -> User: 좌석 선택 페이지로 라우팅
@enduml
```

